# P2-08.4: Sheet & Viewport Tools

**Goal**: Place views on sheets as viewports and auto-arrange viewport layouts.

**Prerequisites**: P2-08.1 complete (DraftingHelper).

**Status**: Not started

---

## Tools (2)

| Tool | Purpose | RequiresTransaction |
|------|---------|---------------------|
| `place_viewport` | Place view on sheet (with title/type options) | true |
| `auto_arrange_viewports` | Auto-layout viewports (grid/column/auto) | true |

---

## Files to Create

```
src/RevitAI/Tools/DraftingTools/
    PlaceViewportTool.cs
    AutoArrangeViewportsTool.cs
```

---

## Key API Details

### Viewport Creation
```csharp
Viewport.CanAddViewToSheet(doc, sheetId, viewId);
var viewport = Viewport.Create(doc, sheetId, viewId, centerPoint);
```

### Auto-Arrange Algorithm
Row-based bin packing:
1. Get all viewports on sheet via `sheet.GetAllViewports()`
2. Get each viewport's bounding box via `GetBoxOutline()`
3. Sort by height (tallest first)
4. Place left-to-right with spacing
5. New row when width exceeded
6. Center rows horizontally
7. Fall back to standard sheet dims (34"x22" for D-size) if title block BB unavailable

### Viewport Properties
```csharp
viewport.GetBoxCenter();  // Current center
viewport.GetBoxOutline(); // Bounding box
viewport.SetBoxCenter(newCenter);  // Reposition
```

---

## Verification (Manual)

1. Create a sheet and several views
2. "Place Floor Plan Level 1 on sheet A101 at the center"
3. "Auto-arrange all viewports on sheet A101"
4. Verify viewports don't overlap and are reasonably laid out
