# P2-08.3: Region + Component Tools

**Goal**: Enable creation of filled regions, masking regions, custom region types, and placement of detail components and groups.

**Prerequisites**: P2-08.1 complete (DraftingHelper â€” `BuildClosedCurveLoop`, `ResolveDetailView`, `ParsePointArray`).

**Status**: Not started

---

## Tools (5)

| Tool | Purpose | RequiresTransaction |
|------|---------|---------------------|
| `place_filled_region` | Hatched/filled area with pattern | true |
| `place_masking_region` | White-out masking area | true |
| `create_filled_region_type` | Create new region type (pattern + color) | true |
| `place_detail_component` | Insert detail component family | true |
| `place_detail_group` | Place detail group instance | true |

---

## Files to Create

```
src/RevitAI/Tools/DraftingTools/
    PlaceFilledRegionTool.cs
    PlaceMaskingRegionTool.cs
    CreateFilledRegionTypeTool.cs
    PlaceDetailComponentTool.cs
    PlaceDetailGroupTool.cs
```

---

## Key API Details

### FilledRegion
```csharp
FilledRegion.Create(doc, regionTypeId, viewId, new List<CurveLoop> { curveLoop });
```

### Masking Region
Same API as filled region but uses a `FilledRegionType` where `IsMasking == true`.

### Creating FilledRegionType
Duplicate an existing type and set pattern/color:
```csharp
var existing = new FilteredElementCollector(doc)
    .OfClass(typeof(FilledRegionType))
    .Cast<FilledRegionType>()
    .First();
var newType = existing.Duplicate(name) as FilledRegionType;
newType.ForegroundPatternId = patternElement.Id;
newType.ForegroundPatternColor = new Color(r, g, b);
```

### Detail Component Placement
```csharp
doc.Create.NewFamilyInstance(location, symbol, view);
```
Must call `symbol.Activate()` if not already active.

### Detail Group Placement
```csharp
var groupType = doc.GetElement(groupTypeId) as GroupType;
// Filter by GroupType.GroupKind for detail groups
doc.Create.PlaceGroup(location, groupType);
```

---

## Verification (Manual)

1. "Create a concrete-filled region from (0,0) to (10,10)"
2. "Add a masking region over area (5,5) to (15,15)"
3. "Create a new region type called 'Cross Hatch Red' with diagonal pattern in red"
4. "Insert a break line symbol at location 5,5"
5. "Place detail group 'Typical Section' at 10,10"
